lua port of 
(a) the cl.hpp file
(b) my CLCommon code
